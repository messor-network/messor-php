"use strict";(self["webpackChunkfull_with_router_v0_2"]=self["webpackChunkfull_with_router_v0_2"]||[]).push([[991],{2979:function(){},5767:function(){},1005:function(e,t,a){var n=a(6252),u=a(2262),i=a(9963),s={class:"ms-form-control__field ms-form-control__field-bg"},l=["name","value"],o=(0,n._)("span",{class:"ms-checkbox__icon"},null,-1),r={class:"ms-checkbox__txt"};t["Z"]=(0,n.aZ)({__name:"RadioButtonControl",props:{name:{type:String,required:!0},value:{type:String,required:!0},modelValue:{type:String,required:!0}},emits:["update:modelValue"],setup:function(e,t){var a=t.emit,c=e,d="".concat(c.name).concat(performance.now()),p=(0,n.Fl)({get:function(){return c.modelValue},set:function(e){return a("update:modelValue",e)}});return function(t,a){return(0,n.wg)(),(0,n.iD)("div",s,[(0,n._)("label",{class:"ms-checkbox ms-checkbox-rounded",for:d},[(0,n.wy)((0,n._)("input",{id:d,name:e.name,type:"radio","onUpdate:modelValue":a[0]||(a[0]=function(e){return(0,u.dq)(p)?p.value=e:null}),value:e.value},null,8,l),[[i.G2,(0,u.SU)(p)]]),o,(0,n._)("span",r,[(0,n.WI)(t.$slots,"default")])])])}}})},1826:function(e,t,a){var n=a(6252),u=a(3577),i=a(2262),s=a(9963),l={class:"ms-form-control__field"},o={for:"request-data--path"},r={key:0,class:"ms-form-control__label"};t["Z"]=(0,n.aZ)({__name:"TextInputComponent",props:{title:{type:String},modelValue:{type:String,required:!0}},emits:["update:modelValue"],setup:function(e,t){var a=t.emit,c=e,d=(0,n.Fl)({get:function(){return c.modelValue},set:function(e){return a("update:modelValue",e)}});return function(t,a){return(0,n.wg)(),(0,n.iD)("div",l,[(0,n._)("label",o,[e.title?((0,n.wg)(),(0,n.iD)("span",r,(0,u.zw)(e.title),1)):(0,n.kq)("",!0),(0,n.wy)((0,n._)("input",{id:"request-data--path","onUpdate:modelValue":a[0]||(a[0]=function(e){return(0,i.dq)(d)?d.value=e:null}),class:"ms-form-control ms-form-control-md",type:"text"},null,512),[[s.nr,(0,i.SU)(d)]])])])}}})},6709:function(e,t,a){var n=a(655),u=a(6252),i=a(3577),s=a(2262),l=a(9963),o=a(7061),r=a(8234),c=a(8682),d=a(4312),p=a(4995),_=a(4440),m=a(1833),f=a(6866),b=a(2180),g=a(2718),h=a(1064),v=a(7154),k=function(e){return(0,u.dD)("data-v-6a60b832"),e=e(),(0,u.Cn)(),e},w={key:0},U={class:"ms-settings-page__group"},S={class:"ms-settings-page__group-title"},y={class:"ms-settings-page__group-col"},D={class:"ms-settings-page__group-col"},q={for:"request-data--type_arch"},x={class:"ms-form-control__label"},V={class:"select_wrapper"},Z=["value"],z={key:0,class:"ms-settings-page__group-col ms-settings-page__group-col-fluid"},I={key:0,class:"ms-settings-page__group"},F={class:"ms-settings-page__group-title"},C={class:"ms-settings-page__group-col ms-settings-page__group-col-fluid"},W={class:"ms-page-box__item"},B={class:"ms-page-box__title"},G={class:"ms-page-box__title-icon"},J=["src"],L={class:"ms-page-box__title-txt"},j={class:"ms-page-box__content ms-page-box__content-padding"},P={class:"ms-form"},N={class:"head-col"},R=["for"],E=["id","value"],O=k((function(){return(0,u._)("span",{class:"ms-checkbox__icon"},null,-1)})),A={class:"ms-checkbox__txt"},H={class:"ms-page-box__controls ms-page-box__controls-centered"},Q=k((function(){return(0,u._)("span",{class:"ms-link-primary"},"/",-1)})),T={class:"ms-settings-page__group"},Y={class:"ms-settings-page__group-title"},K={class:"ms-settings-page__group-col ms-settings-page__group-col-fluid"},M={class:(0,i.C_)(["ms-settings-page__group-col","ms-settings-page__group-col-has-hidden","ms-settings-page__group-col-fluid"])},X={class:"ms-settings-page__group-col-hidden"},$={class:"ms-settings-page__group-col ms-settings-page__group-col-fluid"};t["Z"]=(0,u.aZ)({__name:"FileDatabaseBackup",setup:function(e){var t=this,k=(0,g.s)(),ee=(0,h.Q)(),te=function(){return(0,n.mG)(t,void 0,Promise,(function(){return(0,n.Jh)(this,(function(e){switch(e.label){case 0:return[4,ee.fetchInitialState()];case 1:return e.sent(),[4,k.checkLicense(ee.route)];case 2:return e.sent(),[2]}}))}))},ae=function(){ee.requestData.tables=ee.initialData.tables},ne=function(){ee.requestData.tables=[]},ue=function(){return(0,n.mG)(t,void 0,Promise,(function(){var e;return(0,n.Jh)(this,(function(t){switch(t.label){case 0:return[4,ee.excludeFiles()];case 1:switch(t.sent(),e=ee.requestData.action,e){case"download":return[3,2];case"save":return[3,4];case"email":return[3,6]}return[3,8];case 2:return[4,ee.downloadBackup()];case 3:return t.sent(),[3,9];case 4:return[4,ee.storeBackup()];case 5:return t.sent(),[3,9];case 6:return[4,ee.sendBackup()];case 7:return t.sent(),[3,9];case 8:return[3,9];case 9:return[2]}}))}))};return(0,u.bv)((function(){return(0,n.mG)(t,void 0,void 0,(function(){return(0,n.Jh)(this,(function(e){switch(e.label){case 0:return(0,o.g)(),[4,te()];case 1:return e.sent(),[2]}}))}))})),function(e,t){return(0,u.wg)(),(0,u.iD)(u.HY,null,[(0,s.SU)(k).licenseAccepted?(0,u.kq)("",!0):((0,u.wg)(),(0,u.j4)(r.Z,{key:0,"api-route":(0,s.SU)(ee).route},null,8,["api-route"])),(0,s.SU)(ee).loading?((0,u.wg)(),(0,u.j4)(d.Z,{key:1},{default:(0,u.w5)((function(){return[(0,s.SU)(ee).downloadedSize&&(0,s.SU)(ee).totalFileSize?((0,u.wg)(),(0,u.iD)("span",w,(0,i.zw)((100*(0,s.SU)(ee).downloadedSize/((0,s.SU)(ee).totalFileSize||1)).toFixed(1))+"% ",1)):(0,u.kq)("",!0)]})),_:1})):(0,u.kq)("",!0),(0,u.Wm)(v.Z,null,{default:(0,u.w5)((function(){return[(0,u.Wm)(p.Z,{"image-url":a(1974),"sub-title":(0,s.SU)(o.I)("backup_descript"),title:"Backup"},{"default-settings":(0,u.w5)((function(){return[(0,u.Wm)(m.Z,{modelValue:(0,s.SU)(ee).requestData.path,"onUpdate:modelValue":t[0]||(t[0]=function(e){return(0,s.SU)(ee).requestData.path=e}),title:(0,s.SU)(o.I)("backup_path")},null,8,["modelValue","title"]),(0,u.Wm)(_.Z,{modelValue:(0,s.SU)(ee).requestData.type_backup,"onUpdate:modelValue":t[1]||(t[1]=function(e){return(0,s.SU)(ee).requestData.type_backup=e}),name:"type_backup",value:"backup_file"},{default:(0,u.w5)((function(){return[(0,u.Uk)((0,i.zw)((0,s.SU)(o.I)("backup_file")),1)]})),_:1},8,["modelValue"]),(0,u.Wm)(_.Z,{modelValue:(0,s.SU)(ee).requestData.type_backup,"onUpdate:modelValue":t[2]||(t[2]=function(e){return(0,s.SU)(ee).requestData.type_backup=e}),name:"type_backup",value:"backup_db"},{default:(0,u.w5)((function(){return[(0,u.Uk)((0,i.zw)((0,s.SU)(o.I)("backup_database")),1)]})),_:1},8,["modelValue"]),(0,u._)("button",{class:"ms-btn-start ms-btn ms-btn-primary",type:"submit",onClick:ue},(0,i.zw)((0,s.SU)(o.I)("backup_button_database")),1)]})),"professional-settings":(0,u.w5)((function(){return[(0,u._)("div",U,[(0,u._)("span",S,(0,i.zw)((0,s.SU)(o.I)("backup_archiving_setting")),1),(0,u._)("div",y,[(0,u.Wm)(m.Z,{modelValue:(0,s.SU)(ee).requestData.filename,"onUpdate:modelValue":t[3]||(t[3]=function(e){return(0,s.SU)(ee).requestData.filename=e}),title:(0,s.SU)(o.I)("backup_file_name")},null,8,["modelValue","title"])]),(0,u._)("div",D,[(0,u._)("label",q,[(0,u._)("span",x,(0,i.zw)((0,s.SU)(o.I)("backup_pack")),1),(0,u._)("span",V,[(0,u.wy)((0,u._)("select",{id:"request-data--type_arch","onUpdate:modelValue":t[4]||(t[4]=function(e){return(0,s.SU)(ee).requestData.type_arch=e}),class:"ms-form-control ms-form-control-md",name:"type_arch"},[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(Object.entries((0,s.SU)(ee).initialData.avaliable_arch),(function(e){var t=e[0],a=e[1];return(0,u.wg)(),(0,u.iD)("option",{key:t,value:a},(0,i.zw)(t),9,Z)})),128))],512),[[l.bM,(0,s.SU)(ee).requestData.type_arch]])])])]),"backup_file"===(0,s.SU)(ee).requestData.type_backup?((0,u.wg)(),(0,u.iD)("div",z,[(0,u.Wm)(f.Z,{modelValue:(0,s.SU)(ee).excludedFiles,"onUpdate:modelValue":t[5]||(t[5]=function(e){return(0,s.SU)(ee).excludedFiles=e}),name:"EXCLUDE_FILES",type:"textarea","field-id":"excludedFiles",title:"".concat((0,s.SU)(o.I)("backup_exclude_directory"),":"),"tooltip-text":(0,s.SU)(o.I)("backup_exclude_directory")},null,8,["modelValue","title","tooltip-text"])])):(0,u.kq)("",!0)]),"backup_db"===(0,s.SU)(ee).requestData.type_backup?((0,u.wg)(),(0,u.iD)("div",I,[(0,u._)("span",F,(0,i.zw)((0,s.SU)(o.I)("backup_settings")),1),(0,u._)("div",C,[(0,u._)("div",W,[(0,u._)("div",B,[(0,u._)("span",G,[(0,u._)("img",{src:a(1713),alt:""},null,8,J)]),(0,u._)("span",L,(0,i.zw)((0,s.SU)(o.I)("backup_select_table")),1),(0,u.Wm)(c.Z,{"tooltip-text":(0,s.SU)(o.I)("backup_i_select_table")},null,8,["tooltip-text"])]),(0,u._)("div",j,[(0,u._)("div",P,[(0,u._)("table",null,[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)((0,s.SU)(ee).initialData.tables,(function(e){return(0,u.wg)(),(0,u.iD)("tr",{key:e},[(0,u._)("td",N,[(0,u._)("label",{for:"".concat(e,"-table-name-checkbox"),class:"ms-checkbox"},[(0,u.wy)((0,u._)("input",{id:"".concat(e,"-table-name-checkbox"),"onUpdate:modelValue":t[6]||(t[6]=function(e){return(0,s.SU)(ee).requestData.tables=e}),value:e,name:"tables[]",type:"checkbox"},null,8,E),[[l.e8,(0,s.SU)(ee).requestData.tables]]),O],8,R)]),(0,u._)("td",null,[(0,u._)("span",A,(0,i.zw)(e),1)])])})),128))])])]),(0,u._)("div",H,[(0,u._)("button",{id:"allenable",class:"ms-link-primary",onClick:ae},(0,i.zw)((0,s.SU)(o.I)("backup_select_all")),1),Q,(0,u._)("button",{id:"alldisable",class:"ms-link-primary",onClick:ne},(0,i.zw)((0,s.SU)(o.I)("backup_remove_select")),1)])])])])):(0,u.kq)("",!0),(0,u._)("div",T,[(0,u._)("span",Y,(0,i.zw)((0,s.SU)(o.I)("backup_action")),1),(0,u._)("div",K,[(0,u.Wm)(_.Z,{modelValue:(0,s.SU)(ee).requestData.action,"onUpdate:modelValue":t[7]||(t[7]=function(e){return(0,s.SU)(ee).requestData.action=e}),name:"action",value:"download"},{default:(0,u.w5)((function(){return[(0,u.Uk)((0,i.zw)((0,s.SU)(o.I)("backup_download")),1)]})),_:1},8,["modelValue"])]),(0,u._)("div",M,[(0,u.Wm)(_.Z,{modelValue:(0,s.SU)(ee).requestData.action,"onUpdate:modelValue":t[8]||(t[8]=function(e){return(0,s.SU)(ee).requestData.action=e}),name:"action",value:"email"},{default:(0,u.w5)((function(){return[(0,u.Uk)((0,i.zw)((0,s.SU)(o.I)("backup_send_of_email")),1)]})),_:1},8,["modelValue"]),(0,u._)("div",X,[(0,u.Wm)(m.Z,{modelValue:(0,s.SU)(ee).requestData.email_user,"onUpdate:modelValue":t[9]||(t[9]=function(e){return(0,s.SU)(ee).requestData.email_user=e}),title:"Email"},null,8,["modelValue"])])]),(0,u._)("div",$,[(0,u.Wm)(_.Z,{modelValue:(0,s.SU)(ee).requestData.action,"onUpdate:modelValue":t[10]||(t[10]=function(e){return(0,s.SU)(ee).requestData.action=e}),name:"action",value:"save"},{default:(0,u.w5)((function(){return[(0,u.Uk)((0,i.zw)((0,s.SU)(o.I)("backup_save_on_server")),1)]})),_:1},8,["modelValue"])])])]})),_:1},8,["image-url","sub-title"])]})),_:1}),(0,s.SU)(k).hasError?((0,u.wg)(),(0,u.j4)(b.Z,{key:2})):(0,u.kq)("",!0)],64)}}})},1064:function(e,t,a){a.d(t,{Q:function(){return o}});var n=a(655),u=a(6086),i=a(8127),s=a(3168),l="extension/module/messor/FDBBApi",o=(0,u.Q_)("file-database-backup",{state:function(){return{loading:!1,initialData:{filename:"",avaliable_arch:{},tables:[],type_backup:[],exclude:[],email:"",path:"",action:""},requestData:{path:"",action:"download",type_arch:".zip",type_backup:"backup_db",filename:"",tables:[],email_user:""},excludedFiles:"",totalFileSize:0,downloadedSize:0}},getters:{route:function(){return l}},actions:{fetchInitialState:function(e){return void 0===e&&(e=!0),(0,n.mG)(this,void 0,Promise,(function(){var t,a,u,s,o,r,c;return(0,n.Jh)(this,(function(d){switch(d.label){case 0:return this.loading=e,[4,(0,i.Nv)(l,"main")];case 1:return t=d.sent(),a=t.data,u=t.status,"ok"!==u.toLocaleLowerCase()?(this.loading=!1,[2]):(this.initialData=(0,n.pi)({},a||this.initialData),s=a.filename,o=a.exclude,r=a.email,c=a.path,this.requestData=(0,n.pi)((0,n.pi)({},this.requestData),{path:c,filename:s,email_user:r}),this.excludedFiles=(null===o||void 0===o?void 0:o.join("\n"))||"",this.loading=!1,[2])}}))}))},excludeFiles:function(){return(0,n.mG)(this,void 0,Promise,(function(){return(0,n.Jh)(this,(function(e){switch(e.label){case 0:return this.loading=!0,[4,(0,i.Nv)(l,"exclude",{exclude:this.excludedFiles.split("\n")})];case 1:return e.sent(),this.loading=!1,[2]}}))}))},storeBackup:function(){return(0,n.mG)(this,void 0,Promise,(function(){return(0,n.Jh)(this,(function(e){switch(e.label){case 0:return this.loading=!0,[4,(0,i.Nv)(l,"save",this.requestData)];case 1:return e.sent(),this.loading=!1,[2]}}))}))},sendBackup:function(){return(0,n.mG)(this,void 0,Promise,(function(){return(0,n.Jh)(this,(function(e){switch(e.label){case 0:return this.loading=!0,[4,(0,i.Nv)(l,"email",this.requestData)];case 1:return e.sent(),this.loading=!1,[2]}}))}))},downloadBackup:function(){return(0,n.mG)(this,void 0,Promise,(function(){var e,t,a,u=this;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:return this.loading=!0,[4,(0,s.S)(l,this.requestData,(function(e){var t=e.loaded,a=e.total;u.downloadedSize=t,u.totalFileSize=a}))];case 1:return e=n.sent(),t=e.data,a=e.fileName,t&&(0,s.k)(t,a),this.loading=!1,[2]}}))}))}}})},3168:function(e,t,a){a.d(t,{S:function(){return i},k:function(){return s}});var n=a(655),u=a(8127);function i(e,t,a){return(0,n.mG)(this,void 0,Promise,(function(){var i,s,l,o,r,c,d,p;return(0,n.Jh)(this,(function(_){switch(_.label){case 0:return i={method:"POST",body:JSON.stringify(t),headers:{Accept:"application/json","Content-Type":"application/json"},credentials:"include"},[4,fetch("".concat((0,u.VN)(),"&route=").concat(e),i)];case 1:return s=_.sent(),l=s.headers.get("content-length")||"0",o=parseInt(l,10),r=0,c="",d=new Response(new ReadableStream({start:function(e){var t;return(0,n.mG)(this,void 0,void 0,(function(){var u,i,l,d,p;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:if(u=null===(t=s.body)||void 0===t?void 0:t.getReader(),!u)return[2];if(i=s.headers.get("Content-Disposition"),!i)return[2];c=i.substring(i.indexOf("filename=")+9),n.label=1;case 1:return[4,u.read()];case 2:if(l=n.sent(),d=l.done,p=l.value,d||!p)return[3,4];r+=p.byteLength,a({loaded:r,total:o}),e.enqueue(p),n.label=3;case 3:return[3,1];case 4:return e.close(),[2]}}))}))}})),p={},[4,d.blob()];case 2:return[2,(p.data=_.sent(),p.fileName=c,p)]}}))}))}var s=function(e,t){var a=document.createElement("a");document.body.appendChild(a),a.style.display="none";var n=window.URL.createObjectURL(e);a.href=n,a.download=t,a.click(),window.URL.revokeObjectURL(n)}},4440:function(e,t,a){var n=a(634);a(4848);const u=n.Z;t["Z"]=u},1833:function(e,t,a){var n=a(9400);const u=n.Z;t["Z"]=u},205:function(e,t,a){a.r(t);var n=a(2257),u=(a(178),a(3744));const i=(0,u.Z)(n.Z,[["__scopeId","data-v-6a60b832"]]);t["default"]=i},4848:function(e,t,a){a(2979)},178:function(e,t,a){a(5767)},634:function(e,t,a){a.d(t,{Z:function(){return n.Z}});var n=a(1005)},9400:function(e,t,a){a.d(t,{Z:function(){return n.Z}});var n=a(1826)},2257:function(e,t,a){a.d(t,{Z:function(){return n.Z}});var n=a(6709)},1713:function(e,t,a){e.exports=a.p+"image/messor/icon-table.ecb5460e.svg"},1974:function(e,t,a){e.exports=a.p+"image/messor/backup.08c9b99a.png"}}]);